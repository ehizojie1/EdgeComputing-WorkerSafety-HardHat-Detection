*Quick links :*
[Home](/README.md) - [Label Data](/part1/LABEL.md) - [Cloud Setup](/part1/CLOUDSETUP.md) - [**Train Model**](/part1/TRAIN.md) - [Setup Jetson](/part2/JETSON.md) - [Edge Inferencing](/part2/EDGEINFER.md) - [Horizon Hub](/part3/HZNHUB.md) - [Horizon Client](/part3/HZNCLIENT.md) - [Docker Model](/part4/DOCKERMODEL.md) - [Horizon Deploy](/part4/HZNDEPLOY.md)
***

# Edge Computing Worker Safety Hard Hat Detection - Section 3

## Train and Test a Hard Hat Detection Model

This section demonstrates how to install the Cloud Annotations cacli, train a Tensorflow model, download the model, set up a sample localhost web application and test model on your laptop.

### Lab Objectives

In this lab you will learn how to:

- Install Cloud Annotations cacli
- Train a Tensorflow model
- Download the model with the cacli
- git clone object-detection-react
- Test model on your laptop

### Cloud Annotations cacli Install

Now that the Hard Hat training data set has been uploaded to IBM Cloud Object Storage, we can train our model using the Cloud Annotations command line interface, ```cacli```

The cacli is available for Linux, Mac, Windows.  Follow the [download and installation instructions](https://cloud.annotations.ai/docs#installing-the-cli)

### Cloud Annotations - Login / Train

- Login to your IBM Cloud account using ```cacli login``` and answer the OTP prompts

```
$ cacli login
receive a One-Time Passcode from https://identity-3.us-south.iam.cloud.ibm.com/identity/passcode to proceed.
open the URL in the default browser? yes
One-Time Passcode ‚ùØ abcdefghi
Account IBM (07aee6e2c2ef4660940cb1b818a12f07)
Object Storage Instance cloud-object-storage-dg
Machine Learning Instance Machine Learning-by

success you are now logged in
```

- Train your hard hat object detection model
```
$ cacli train
```
- Select your ```hardhat-detection-<your_initials>``` Bucket.
- List training runs
```
$ cacli list
```
- Monitor the progress of your training runs
```
$ cacli progress model-58sdpqyx
success model files saved to bucket
```
- When it completes (15-30 minutes), download the model
```
$ cacli download model-58sdpqyx
success download complete
```

### Set up a Object Detection web application on your local system

The [Cloud Annotations github repository](https://github.com/cloud-annotations) includes an [object detection react](https://github.com/cloud-annotations/object-detection-react) web application that you can install locally.

Follow the [README.md instructions](https://github.com/cloud-annotations/object-detection-react/blob/master/README.md)
- Run these commands:
```
$ git clone git@github.com:cloud-annotations/object-detection-react.git
$ cd object-detection-react
$ npm install
```
- Copy the **model_web** directory generated by the ```cacli download``` and paste it into the ```public``` folder of this repo directory.   On my Linux system I just create a symlink.

- Start the server
```
$ npm start
```

## Test the Hard Hat model on your laptop

Now that the **object detection react** web application is running, open http://localhost:3000 to view it in the browser. Share your laptop camera with the browser tab.

Find your hard hat and observe the hard hat model prediction.

![author with a hardhat](/images/Sample-HardHat-Detection-Author.png)

### Congratulations

You are now ready to set up your Nvidia Jetson Nano, so proceed to the next [Jetson Setup section](/part2/JETSON.md).

***
[Home](/README.md) - [Label Data](/part1/LABEL.md) - [Cloud Setup](/part1/CLOUDSETUP.md) - [**Train Model**](/part1/TRAIN.md) - [Setup Jetson](/part2/JETSON.md) - [Edge Inferencing](/part2/EDGEINFER.md) - [Horizon Hub](/part3/HZNHUB.md) - [Horizon Client](/part3/HZNCLIENT.md) - [Docker Model](/part4/DOCKERMODEL.md) - [Horizon Deploy](/part4/HZNDEPLOY.md)
***
